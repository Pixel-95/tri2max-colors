<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>tri2max Design</title>
  <link rel="icon" type="image/png" href="./assets/tri2max_logo_darkMode.png" />
  <link rel="stylesheet" href="./tokens.css?v=20260220-1" />
</head>

<body>
  <main>
    <header>
      <img src="./assets/tri2max_logo_lightMode.png" alt="Tri2Max logo" />
      <span>TRI2MAX</span>
    </header>

    <h1 id="main-heading">Main Heading</h1>
    <p>A muted shade for the rest of the text.</p>
    <p>You can open a modal here:
      <button class="button button-inline" type="button">Learn more</button>,
      but be careful.
    </p>

    <div style="display: grid; gap: 0.75rem;">
      <button id="theme-toggle" class="button button-primary" type="button" aria-label="Toggle theme">Go to light mode</button>
      <button id="primary-toggle" class="button button-secondary" type="button" aria-pressed="false">Change Primary Color</button>
    </div>

    <section class="card" aria-label="Output card">
      <div>
        <span>Heart rate</span>
        <output><strong id="output-heart-rate">156&hairsp;bpm</strong></output>
      </div>
      <div>
        <span>Power</span>
        <output><strong id="output-power">351&hairsp;W</strong></output>
      </div>
      <div>
        <span>Pace</span>
        <output><strong id="output-pace">4:05/km</strong></output>
      </div>
      <div>
        <label for="field-text">Heading</label>
        <input id="field-text" class="input" type="text" value="Main Heading" />
      </div>
      <button id="card-button" class="button button-secondary" type="button">Randomize Values</button>
    </section>

    <form aria-label="Form elements">
      <div>
        <span>Use Gradient</span>
        <label class="switch" for="field-switch">
          <input id="field-switch" type="checkbox" checked />
          <span aria-hidden="true"></span>
        </label>
      </div>

      <div>
        <label for="field-slider">Pace</label>
        <input id="field-slider" class="input input-range" type="range" min="0" max="100" value="23" />
      </div>

      <div>
        <label for="field-select">Unit System</label>
        <select id="field-select" class="input">
          <option value="metric">Metric</option>
          <option value="imperial">Imperial</option>
        </select>
      </div>

      <div>
        <span>Notification</span>
        <fieldset>
          <label>
            <input type="radio" name="field-radio" value="success" checked />
            Success
          </label>
          <label>
            <input type="radio" name="field-radio" value="warning" />
            Warning
          </label>
          <label>
            <input type="radio" name="field-radio" value="destructive" />
            Destructive
          </label>
        </fieldset>
      </div>

      <div>
        <span>Danger Zone</span>
        <label for="field-checkbox">
          <input id="field-checkbox" type="checkbox" />
          Show
        </label>
      </div>
    </form>

    <section id="danger-zone-area" style="display: grid; gap: 0.75rem;">
      <div class="separator" aria-hidden="true"></div>
      <h2>Danger Zone</h2>
      <button id="delete-universe" class="button button-destructive" type="button">Reset Values</button>
      <button class="button button-secondary" type="button" disabled>Deactivated</button>
      <div class="separator" aria-hidden="true"></div>
      <section aria-label="Notifications">
        <p id="notification-success" class="notification" data-tone="success">Success: Changes were saved successfully.</p>
        <p id="notification-warning" class="notification" data-tone="warning">Warning: Your session will expire in 2 minutes.</p>
        <p id="notification-destructive" class="notification" data-tone="destructive">Destructive: This action cannot be undone.</p>
      </section>
    </section>
  </main>

  <script>
    (function () {
      const root = document.documentElement;
      const toggleButton = document.getElementById("theme-toggle");
      const primaryToggleButton = document.getElementById("primary-toggle");
      const dangerZoneToggle = document.getElementById("field-checkbox");
      const dangerZoneArea = document.getElementById("danger-zone-area");
      const mainHeading = document.getElementById("main-heading");
      const headingInput = document.getElementById("field-text");
      const heartRateOutput = document.getElementById("output-heart-rate");
      const powerOutput = document.getElementById("output-power");
      const paceOutput = document.getElementById("output-pace");
      const cardButton = document.getElementById("card-button");
      const paceSlider = document.getElementById("field-slider");
      const unitSelect = document.getElementById("field-select");
      const notificationRadios = document.querySelectorAll('input[name="field-radio"]');
      const notifications = document.querySelectorAll(".notification[data-tone]");
      const deleteUniverseButton = document.getElementById("delete-universe");
      const gradientSwitch = document.getElementById("field-switch");
      const STORAGE_KEY = "mockup-theme";
      const PRIMARY_STORAGE_KEY = "mockup-primary-color";
      const DANGER_ZONE_STORAGE_KEY = "mockup-danger-zone-visibility";
      const GRADIENT_STORAGE_KEY = "mockup-gradient-enabled";
      const DEFAULT_HEADING = "Main Heading";
      const DEFAULT_HEART_RATE = 156;
      const DEFAULT_POWER = 351;
      const DEFAULT_SLIDER = 23;
      const DEFAULT_UNIT = "metric";
      const DEFAULT_NOTIFICATION_TONE = "success";
      const DEFAULT_DANGER_ZONE_VISIBLE = false;
      const HAIR_SPACE = "\u200A";

      const setTheme = (theme) => {
        if (theme === "light") {
          root.setAttribute("data-theme", "light");
        } else {
          root.removeAttribute("data-theme");
        }

        toggleButton.textContent = theme === "light" ? "Go to dark mode" : "Go to light mode";
      };

      const savedTheme = localStorage.getItem(STORAGE_KEY);
      setTheme(savedTheme === "light" ? "light" : "dark");

      toggleButton.addEventListener("click", () => {
        const isLightMode = root.getAttribute("data-theme") === "light";
        const nextTheme = isLightMode ? "dark" : "light";
        localStorage.setItem(STORAGE_KEY, nextTheme);
        setTheme(nextTheme);
      });

      const setPrimaryColor = (color) => {
        if (color === "primary2") {
          root.setAttribute("data-primary", "primary2");
        } else {
          root.removeAttribute("data-primary");
        }

        if (!primaryToggleButton) {
          return;
        }

        const isPrimary2 = color === "primary2";
        primaryToggleButton.setAttribute("aria-pressed", isPrimary2 ? "true" : "false");
      };

      const savedPrimaryColor = localStorage.getItem(PRIMARY_STORAGE_KEY);
      setPrimaryColor(savedPrimaryColor === "primary2" ? "primary2" : "primary");

      primaryToggleButton?.addEventListener("click", () => {
        const isPrimary2 = root.getAttribute("data-primary") === "primary2";
        const nextPrimaryColor = isPrimary2 ? "primary" : "primary2";
        setPrimaryColor(nextPrimaryColor);

        if (nextPrimaryColor === "primary2") {
          localStorage.setItem(PRIMARY_STORAGE_KEY, "primary2");
        } else {
          localStorage.removeItem(PRIMARY_STORAGE_KEY);
        }
      });

      const setGradientMode = (isEnabled) => {
        if (isEnabled) {
          root.setAttribute("data-gradient", "enabled");
        } else {
          root.removeAttribute("data-gradient");
        }

        if (gradientSwitch) {
          gradientSwitch.checked = isEnabled;
        }
      };

      const savedGradientMode = localStorage.getItem(GRADIENT_STORAGE_KEY);
      const initialGradientMode = savedGradientMode === null
        ? gradientSwitch?.checked ?? false
        : savedGradientMode === "enabled";
      setGradientMode(initialGradientMode);

      gradientSwitch?.addEventListener("change", (event) => {
        const isEnabled = event.target.checked;
        setGradientMode(isEnabled);
        localStorage.setItem(GRADIENT_STORAGE_KEY, isEnabled ? "enabled" : "disabled");
      });

      const setDangerZoneVisibility = (isVisible) => {
        dangerZoneArea.style.display = isVisible ? "grid" : "none";
        dangerZoneToggle.checked = isVisible;
      };

      const savedDangerZoneVisibility = localStorage.getItem(DANGER_ZONE_STORAGE_KEY);
      const initialDangerZoneVisible = savedDangerZoneVisibility === null
        ? dangerZoneToggle?.checked ?? false
        : savedDangerZoneVisibility === "visible";
      setDangerZoneVisibility(initialDangerZoneVisible);

      dangerZoneToggle?.addEventListener("change", (event) => {
        const isVisible = event.target.checked;
        setDangerZoneVisibility(isVisible);
        localStorage.setItem(DANGER_ZONE_STORAGE_KEY, isVisible ? "visible" : "hidden");
      });

      const setHeartRate = (value) => {
        heartRateOutput.textContent = `${value}${HAIR_SPACE}bpm`;
      };

      const setPower = (value) => {
        powerOutput.textContent = `${value}${HAIR_SPACE}W`;
      };

      const setRangePercent = (rangeInput) => {
        const min = Number(rangeInput.min || 0);
        const max = Number(rangeInput.max || 100);
        const value = Number(rangeInput.value || min);
        const span = max - min;
        const percent = span === 0 ? 0 : ((value - min) / span) * 100;
        rangeInput.style.setProperty("--range-percent", `${percent}%`);
      };

      const randomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

      const paceFromSliderValue = (value) => {
        const minSeconds = 3 * 60 + 30;
        const maxSeconds = 6 * 60;
        return Math.round(minSeconds + ((maxSeconds - minSeconds) * value) / 100);
      };

      const formatPace = (totalSeconds, unit) => {
        const minutes = Math.floor(totalSeconds / 60);
        const seconds = String(totalSeconds % 60).padStart(2, "0");
        const suffix = unit === "imperial" ? "/mile" : "/km";
        return `${minutes}:${seconds}${suffix}`;
      };

      const setPace = () => {
        const sliderValue = Number(paceSlider.value || DEFAULT_SLIDER);
        const paceSeconds = paceFromSliderValue(sliderValue);
        paceOutput.textContent = formatPace(paceSeconds, unitSelect.value);
      };

      const setNotificationTone = (tone) => {
        notifications.forEach((notification) => {
          notification.hidden = notification.dataset.tone !== tone;
        });

        notificationRadios.forEach((radio) => {
          radio.checked = radio.value === tone;
        });
      };

      const resetUniverse = () => {
        localStorage.removeItem(STORAGE_KEY);
        localStorage.removeItem(PRIMARY_STORAGE_KEY);
        localStorage.removeItem(GRADIENT_STORAGE_KEY);
        localStorage.removeItem(DANGER_ZONE_STORAGE_KEY);

        setTheme("dark");
        setPrimaryColor("primary");
        setGradientMode(true);

        headingInput.value = DEFAULT_HEADING;
        mainHeading.textContent = DEFAULT_HEADING;

        setHeartRate(DEFAULT_HEART_RATE);
        setPower(DEFAULT_POWER);

        paceSlider.value = String(DEFAULT_SLIDER);
        setRangePercent(paceSlider);
        unitSelect.value = DEFAULT_UNIT;
        setPace();

        setNotificationTone(DEFAULT_NOTIFICATION_TONE);
        setDangerZoneVisibility(DEFAULT_DANGER_ZONE_VISIBLE);
      };

      headingInput.addEventListener("input", () => {
        const nextHeading = headingInput.value.trim();
        mainHeading.textContent = nextHeading || DEFAULT_HEADING;
      });

      cardButton.addEventListener("click", () => {
        setHeartRate(randomInt(100, 180));
        setPower(randomInt(150, 400));
      });

      paceSlider.addEventListener("input", () => {
        setRangePercent(paceSlider);
        setPace();
      });

      unitSelect.addEventListener("change", () => {
        setPace();
      });

      notificationRadios.forEach((radio) => {
        radio.addEventListener("change", () => {
          if (radio.checked) {
            setNotificationTone(radio.value);
          }
        });
      });

      deleteUniverseButton.addEventListener("click", () => {
        resetUniverse();
      });

      mainHeading.textContent = headingInput.value.trim() || DEFAULT_HEADING;
      setHeartRate(DEFAULT_HEART_RATE);
      setPower(DEFAULT_POWER);
      setRangePercent(paceSlider);
      setPace();
      setNotificationTone(DEFAULT_NOTIFICATION_TONE);
    })();
  </script>
</body>

</html>
